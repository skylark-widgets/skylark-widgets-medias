{"version":3,"sources":["audio-player.js"],"names":["define","eventer","Widget","medias","_context","AudioContext","undefined","window","webkitAudioContext","AudioPlayer","inherit","_construct","parent","prototype","call","this","_elm","style","overflow","self","context","timer","document","createElement","position","display","justifyContent","alignItems","width","height","right","appendChild","timerText","createTextNode","button","cursor","background","border","outline","onclick","toggle","icon","left","top","src","Global","FILE_PATH","track","backgroundColor","Editor","theme","audioTrack","progress","pointerEvents","audioProgress","scrubber","audioScrubber","buffer","source","time","startTime","playing","loop","seekStart","seekTime","seekProgress","dragging","on","event","pageX","duration","play","onmousedown","manager","create","stopPropagation","layerX","offsetWidth","draw","currentTime","seconds","Math","round","minutes","data","stop","requestAnimationFrame","setAudioBuffer","onLoad","decodeAudioData","slice","bind","connect","pause","createBufferSource","destination","disconnect","start","seek","destroy","e","_updateSize","size","y","x"],"mappings":";;;;;;;AAAAA,QACC,uBACA,8BACA,YACC,SAASC,EAASC,EAAOC,GAC1B,aAEA,IAAIC,EAEAC,EAES,WAQX,YANkBC,IAAbF,IAEJA,EAAW,IAAMG,OAAOF,cAAgBE,OAAOC,qBAIzCJ,GAaLK,EAAcP,EAAOQ,SAExBC,WAAa,SAAUC,GACtBV,EAAOW,UAAUF,WAAWG,KAAKC,KAAMH,EAAQ,OAE/CG,KAAKC,KAAKC,MAAMC,SAAW,UAE3B,IAAIC,EAAOJ,KAGXA,KAAKK,QAAUf,IAGfU,KAAKM,MAAQC,SAASC,cAAc,OACpCR,KAAKM,MAAMJ,MAAMO,SAAW,WAC5BT,KAAKM,MAAMJ,MAAMQ,QAAU,OAC3BV,KAAKM,MAAMJ,MAAMS,eAAiB,SAClCX,KAAKM,MAAMJ,MAAMU,WAAa,SAC9BZ,KAAKM,MAAMJ,MAAMW,MAAQ,OACzBb,KAAKM,MAAMJ,MAAMY,OAAS,OAC1Bd,KAAKM,MAAMJ,MAAMa,MAAQ,MACzBf,KAAKC,KAAKe,YAAYhB,KAAKM,OAG3BN,KAAKiB,UAAYV,SAASW,eAAe,SACzClB,KAAKM,MAAMU,YAAYhB,KAAKiB,WAG5BjB,KAAKmB,OAASZ,SAASC,cAAc,UACrCR,KAAKmB,OAAOjB,MAAMO,SAAW,WAC7BT,KAAKmB,OAAOjB,MAAMkB,OAAS,UAC3BpB,KAAKmB,OAAOjB,MAAMmB,WAAa,cAC/BrB,KAAKmB,OAAOjB,MAAMoB,OAAS,OAC3BtB,KAAKmB,OAAOjB,MAAMqB,QAAU,OAC5BvB,KAAKC,KAAKe,YAAYhB,KAAKmB,QAC3BnB,KAAKmB,OAAOK,QAAU,WACrBpB,EAAKqB,UAINzB,KAAK0B,KAAOnB,SAASC,cAAc,OACnCR,KAAK0B,KAAKxB,MAAMO,SAAW,WAC3BT,KAAK0B,KAAKxB,MAAMyB,KAAO,MACvB3B,KAAK0B,KAAKxB,MAAM0B,IAAM,MACtB5B,KAAK0B,KAAKxB,MAAMW,MAAQ,MACxBb,KAAK0B,KAAKxB,MAAMY,OAAS,MACzBd,KAAK0B,KAAKG,IAAMC,OAAOC,UAAY,sBACnC/B,KAAKmB,OAAOH,YAAYhB,KAAK0B,MAG7B1B,KAAKgC,MAAQzB,SAASC,cAAc,OACpCR,KAAKgC,MAAM9B,MAAMO,SAAW,WAC5BT,KAAKgC,MAAM9B,MAAM+B,gBAAkBC,OAAOC,MAAMC,WAChDpC,KAAKgC,MAAM9B,MAAMkB,OAAS,UAC1BpB,KAAKC,KAAKe,YAAYhB,KAAKgC,OAG3BhC,KAAKqC,SAAW9B,SAASC,cAAc,OACvCR,KAAKqC,SAASnC,MAAMoC,cAAgB,OACpCtC,KAAKqC,SAASnC,MAAMO,SAAW,WAC/BT,KAAKqC,SAASnC,MAAM+B,gBAAkBC,OAAOC,MAAMI,cACnDvC,KAAKqC,SAASnC,MAAMY,OAAS,OAC7Bd,KAAKgC,MAAMhB,YAAYhB,KAAKqC,UAG5BrC,KAAKwC,SAAWjC,SAASC,cAAc,OACvCR,KAAKwC,SAAStC,MAAMO,SAAW,WAC/BT,KAAKwC,SAAStC,MAAM+B,gBAAkBC,OAAOC,MAAMM,cACnDzC,KAAKwC,SAAStC,MAAMkB,OAAS,UAC7BpB,KAAKwC,SAAStC,MAAMW,MAAQ,MAC5Bb,KAAKgC,MAAMhB,YAAYhB,KAAKwC,UAG5BxC,KAAK0C,OAAS,KACd1C,KAAK2C,OAAS,KAGd3C,KAAK4C,KAAO,EACZ5C,KAAK6C,UAAY,EACjB7C,KAAK8C,SAAU,EACf9C,KAAK+C,MAAO,EAGZ/C,KAAKgD,UAAY,EACjBhD,KAAKiD,SAAW,EAChBjD,KAAKkD,aAAe,EACpBlD,KAAKmD,UAAW,EAKhBjE,EAAQkE,GAAG5D,OAAQ,YAAa,SAAS6D,GAExCjD,EAAK8C,cAAgBG,EAAMC,MAAQlD,EAAK4C,WAAc5C,EAAK4B,MAAiB,YAC5E5B,EAAK8C,cAAgB9C,EAAK6C,SAAW7C,EAAKsC,OAAOa,SAE9CnD,EAAK8C,aAAe,EAEtB9C,EAAK8C,aAAe,EAEb9C,EAAK8C,aAAe,IAE3B9C,EAAK8C,aAAe,GAGrB9C,EAAKiC,SAASnC,MAAMW,MAA6B,IAApBT,EAAK8C,aAAsB,IACxD9C,EAAKoC,SAAStC,MAAMyB,KAAOvB,EAAKiC,SAASnC,MAAMW,QAIhD3B,EAAQkE,GAAG5D,OAAQ,UAAW,SAAS6D,GAEtCjD,EAAK+C,UAAW,EAChB/C,EAAKwC,KAAOxC,EAAK8C,aAAe9C,EAAKsC,OAAOa,SAEzCnD,EAAK0C,SAEP1C,EAAKoD,KAAKpD,EAAKwC,QAMjB5C,KAAKwC,SAASiB,YAAc,SAASJ,GACpCjD,EAAK4C,UAAYK,EAAMC,MACvBlD,EAAK6C,SAAW7C,EAAKwC,KACrBxC,EAAK+C,UAAW,EAChB/C,EAAKsD,QAAQC,SAEbN,EAAMO,mBAGP5D,KAAKgC,MAAMyB,YAAc,SAASJ,GACjC,IAAIhB,EAAWgB,EAAMQ,OAAS7D,KAAK8D,YAEnC1D,EAAK8C,aAAeb,EACpBjC,EAAKwC,KAAOP,EAAWjC,EAAKsC,OAAOa,SAEnCnD,EAAKiC,SAASnC,MAAMW,MAA6B,IAApBT,EAAK8C,aAAsB,IACxD9C,EAAKoC,SAAStC,MAAMyB,KAAOvB,EAAKiC,SAASnC,MAAMW,MAE5CT,EAAK0C,SAEP1C,EAAKoD,KAAKpD,EAAKwC,MAGhBxC,EAAKoC,SAASiB,YAAYJ,IAI3B,SAASU,IACR,GAAG3D,EAAK0C,QAAS,CAChB1C,EAAKwC,KAAOxC,EAAKC,QAAQ2D,YAAc5D,EAAKyC,UAE5C,IAAIoB,EAAUC,KAAKC,MAAM/D,EAAKwC,KAAO,IAClCqB,EAAU,KAEZA,EAAU,IAAMA,GAGjB,IAAIG,EAAUF,KAAKC,MAAM/D,EAAKwC,KAAO,IAOrC,GANGwB,EAAU,KACZA,EAAU,IAAMA,GAGjBhE,EAAKa,UAAUoD,KAAOD,EAAU,IAAMH,EAEnB,OAAhB7D,EAAKsC,OAAiB,CACrBtC,EAAKwC,MAAQxC,EAAKsC,OAAOa,UAE3BnD,EAAKkE,OAGN,IAAIjC,EAAYjC,EAAKwC,KAAOxC,EAAKsC,OAAOa,SAAY,IAEhDnD,EAAK+C,WAER/C,EAAKiC,SAASnC,MAAMW,MAAQwB,EAAW,IACvCjC,EAAKoC,SAAStC,MAAMyB,KAAOU,EAAW,MAKtB,OAAhBjC,EAAKP,QACP0E,sBAAsBR,GAGxBA,IAIDS,eAAiB,SAAS9B,EAAQ+B,GACjC,IAAIrE,EAAOJ,KAEXA,KAAKK,QAAQqE,gBAAgBhC,EAAOiC,MAAM,GAAI,SAASjC,GACtDtC,EAAKsC,OAASA,OAEAnD,IAAXkF,GACFA,EAAO/B,IAEPkC,KAAK5E,QAIR6E,QAAU,WACN7E,KAAK8C,SAEP9C,KAAK8E,QAGN9E,KAAK2C,OAAS3C,KAAKK,QAAQ0E,qBAC3B/E,KAAK2C,OAAOD,OAAS1C,KAAK0C,OAC1B1C,KAAK2C,OAAOkC,QAAQ7E,KAAKK,QAAQ2E,cAIlCC,WAAa,WACZjF,KAAK2C,OAAOsC,cAIbzB,KAAO,SAASZ,GACf5C,KAAK6E,eAEOtF,IAATqD,IAEF5C,KAAK4C,KAAOA,GAGb5C,KAAK2C,OAAOI,KAAO/C,KAAK+C,KACxB/C,KAAK6C,UAAY7C,KAAKK,QAAQ2D,YAAchE,KAAK4C,KACjD5C,KAAK2C,OAAOuC,MAAMlF,KAAKK,QAAQ2D,YAAahE,KAAK4C,MACjD5C,KAAK8C,SAAU,EAEf9C,KAAK0B,KAAKG,IAAMC,OAAOC,UAAY,wBAIpC+C,MAAQ,WACJ9E,KAAK8C,UAEP9C,KAAK8C,SAAU,EACf9C,KAAK2C,OAAO2B,OACZtE,KAAK4C,KAAO5C,KAAKK,QAAQ2D,YAAchE,KAAK6C,UAE5C7C,KAAK0B,KAAKG,IAAMC,OAAOC,UAAY,wBAKrCuC,KAAO,WACHtE,KAAK8C,UACP9C,KAAK2C,OAAO2B,OACZtE,KAAK4C,KAAO,EACZ5C,KAAK8C,SAAU,EAEf9C,KAAK0B,KAAKG,IAAMC,OAAOC,UAAY,wBAKrCoD,KAAO,SAASvC,GACZ5C,KAAK8C,QACP9C,KAAKwD,KAAKZ,GAEV5C,KAAK4C,KAAOA,GAKdnB,OAAS,WACJzB,KAAK8C,QAGR9C,KAAK8E,QAFL9E,KAAKwD,QAMP4B,QAAU,WACT,IACCpF,KAAKiF,aACLjF,KAAKsE,OACL,MAAMe,IAEPlG,EAAOW,UAAUsF,QAAQrF,KAAKC,OAG/BsF,YAAc,WACbnG,EAAOW,UAAUwF,YAAYvF,KAAKC,MAGlCA,KAAKmB,OAAOjB,MAAMW,MAAQb,KAAKC,KAAKC,MAAMY,OAC1Cd,KAAKmB,OAAOjB,MAAMY,OAASd,KAAKC,KAAKC,MAAMY,OAG3Cd,KAAKgC,MAAM9B,MAAM0B,IAAqB,IAAd5B,KAAKuF,KAAKC,EAAY,KAC9CxF,KAAKgC,MAAM9B,MAAMyB,KAAsB,KAAd3B,KAAKuF,KAAKC,EAAY,KAC/CxF,KAAKgC,MAAM9B,MAAMW,MAASb,KAAKuF,KAAKE,EAAkB,IAAdzF,KAAKuF,KAAKC,EAAU,GAAM,KAClExF,KAAKgC,MAAM9B,MAAMY,OAAwB,GAAdd,KAAKuF,KAAKC,EAAW,KAGhDxF,KAAKwC,SAAStC,MAAMY,OAAwB,GAAdd,KAAKuF,KAAKC,EAAW,KACnDxF,KAAKwC,SAAStC,MAAM0B,IAAsB,KAAd5B,KAAKuF,KAAKC,EAAY,QAKpD,OAAOpG,EAAOM,YAAcA","file":"../audio-player.js","sourcesContent":["define([\r\n\t\"skylark-domx-eventer\",\r\n\t\"skylark-widgets-base/widget\",\r\n\t\"./medias\"\r\n],function(eventer, Widget,medias){\r\n\t\"use strict\";\r\n\r\n\tvar _context;\r\n\r\n\tvar AudioContext = {\r\n\r\n\t\tgetContext: function () {\r\n\r\n\t\t\tif ( _context === undefined ) {\r\n\r\n\t\t\t\t_context = new ( window.AudioContext || window.webkitAudioContext )();\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn _context;\r\n\r\n\t\t},\r\n\r\n\t\tsetContext: function ( value ) {\r\n\r\n\t\t\t_context = value;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n\tvar AudioPlayer = Widget.inherit({\r\n\r\n\t\t_construct : function (parent){\r\n\t\t\tWidget.prototype._construct.call(this, parent, \"div\");\r\n\r\n\t\t\tthis._elm.style.overflow = \"visible\";\r\n\r\n\t\t\tvar self = this;\r\n\r\n\t\t\t//WebAudio context\r\n\t\t\tthis.context = AudioContext.getContext();\r\n\r\n\t\t\t//Timer\r\n\t\t\tthis.timer = document.createElement(\"div\");\r\n\t\t\tthis.timer.style.position = \"absolute\";\r\n\t\t\tthis.timer.style.display = \"flex\";\r\n\t\t\tthis.timer.style.justifyContent = \"center\";\r\n\t\t\tthis.timer.style.alignItems = \"center\";\r\n\t\t\tthis.timer.style.width = \"40px\";\r\n\t\t\tthis.timer.style.height = \"100%\";\r\n\t\t\tthis.timer.style.right = \"0px\";\r\n\t\t\tthis._elm.appendChild(this.timer);\r\n\r\n\t\t\t//Text\r\n\t\t\tthis.timerText = document.createTextNode(\"00:00\");\r\n\t\t\tthis.timer.appendChild(this.timerText);\r\n\r\n\t\t\t//Button\r\n\t\t\tthis.button = document.createElement(\"button\");\r\n\t\t\tthis.button.style.position = \"absolute\";\r\n\t\t\tthis.button.style.cursor = \"pointer\";\r\n\t\t\tthis.button.style.background = \"transparent\";\r\n\t\t\tthis.button.style.border = \"none\";\r\n\t\t\tthis.button.style.outline = \"none\";\r\n\t\t\tthis._elm.appendChild(this.button);\r\n\t\t\tthis.button.onclick = function() {\r\n\t\t\t\tself.toggle();\r\n\t\t\t};\r\n\r\n\t\t\t//Icon\r\n\t\t\tthis.icon = document.createElement(\"img\");\r\n\t\t\tthis.icon.style.position = \"absolute\";\r\n\t\t\tthis.icon.style.left = \"15%\";\r\n\t\t\tthis.icon.style.top = \"15%\";\r\n\t\t\tthis.icon.style.width = \"70%\";\r\n\t\t\tthis.icon.style.height = \"70%\";\r\n\t\t\tthis.icon.src = Global.FILE_PATH + \"icons/misc/play.png\";\r\n\t\t\tthis.button.appendChild(this.icon);\r\n\r\n\t\t\t//Track\r\n\t\t\tthis.track = document.createElement(\"div\");\r\n\t\t\tthis.track.style.position = \"absolute\";\r\n\t\t\tthis.track.style.backgroundColor = Editor.theme.audioTrack;\r\n\t\t\tthis.track.style.cursor = \"pointer\";\r\n\t\t\tthis._elm.appendChild(this.track);\r\n\r\n\t\t\t//Progress\r\n\t\t\tthis.progress = document.createElement(\"div\");\r\n\t\t\tthis.progress.style.pointerEvents = \"none\";\r\n\t\t\tthis.progress.style.position = \"absolute\";\r\n\t\t\tthis.progress.style.backgroundColor = Editor.theme.audioProgress;\r\n\t\t\tthis.progress.style.height = \"100%\";\r\n\t\t\tthis.track.appendChild(this.progress);\r\n\r\n\t\t\t//Scrubber\r\n\t\t\tthis.scrubber = document.createElement(\"div\");\r\n\t\t\tthis.scrubber.style.position = \"absolute\";\r\n\t\t\tthis.scrubber.style.backgroundColor = Editor.theme.audioScrubber;\r\n\t\t\tthis.scrubber.style.cursor = \"pointer\";\r\n\t\t\tthis.scrubber.style.width = \"6px\";\r\n\t\t\tthis.track.appendChild(this.scrubber);\r\n\r\n\t\t\t//Audio source and buffer\r\n\t\t\tthis.buffer = null;\r\n\t\t\tthis.source = null;\r\n\r\n\t\t\t//Playback control\r\n\t\t\tthis.time = 0;\r\n\t\t\tthis.startTime = 0;\r\n\t\t\tthis.playing = false;\r\n\t\t\tthis.loop = false;\r\n\r\n\t\t\t//Drag control\r\n\t\t\tthis.seekStart = 0;\r\n\t\t\tthis.seekTime = 0;\r\n\t\t\tthis.seekProgress = 0;\r\n\t\t\tthis.dragging = false;\r\n\r\n\t\t\t//Event manager\r\n\t\t\t//this.manager = new EventManager();\r\n\t\t\t//this.manager.add(window, \"mousemove\", function(event)\r\n\t\t\teventer.on(window, \"mousemove\", function(event)\r\n\t\t\t{\r\n\t\t\t\tself.seekProgress = (event.pageX - self.seekStart) / (self.track.offsetWidth);\r\n\t\t\t\tself.seekProgress += self.seekTime / self.buffer.duration;\r\n\r\n\t\t\t\tif(self.seekProgress < 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.seekProgress = 0;\r\n\t\t\t\t}\r\n\t\t\t\telse if(self.seekProgress > 1)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.seekProgress = 1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.progress.style.width = (self.seekProgress * 100) + \"%\";\r\n\t\t\t\tself.scrubber.style.left = self.progress.style.width;\r\n\t\t\t});\r\n\r\n\t\t\t//this.manager.add(window, \"mouseup\", function(event)\r\n\t\t\teventer.on(window, \"mouseup\", function(event)\r\n\t\t\t{\t\r\n\t\t\t\tself.dragging = false;\r\n\t\t\t\tself.time = self.seekProgress * self.buffer.duration;\r\n\r\n\t\t\t\tif(self.playing)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.play(self.time);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//self.manager.destroy();\r\n\t\t\t});\r\n\r\n\t\t\tthis.scrubber.onmousedown = function(event) {\r\n\t\t\t\tself.seekStart = event.pageX;\r\n\t\t\t\tself.seekTime = self.time;\r\n\t\t\t\tself.dragging = true;\r\n\t\t\t\tself.manager.create();\r\n\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t};\r\n\r\n\t\t\tthis.track.onmousedown = function(event) {\r\n\t\t\t\tvar progress = event.layerX / this.offsetWidth;\r\n\r\n\t\t\t\tself.seekProgress = progress;\r\n\t\t\t\tself.time = progress * self.buffer.duration;\r\n\r\n\t\t\t\tself.progress.style.width = (self.seekProgress * 100) + \"%\";\r\n\t\t\t\tself.scrubber.style.left = self.progress.style.width;\r\n\r\n\t\t\t\tif(self.playing)\r\n\t\t\t\t{\r\n\t\t\t\t\tself.play(self.time);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tself.scrubber.onmousedown(event);\r\n\t\t\t};\r\n\r\n\t\t\t//Update elements\r\n\t\t\tfunction draw() {\r\n\t\t\t\tif(self.playing) {\r\n\t\t\t\t\tself.time = self.context.currentTime - self.startTime;\r\n\r\n\t\t\t\t\tvar seconds = Math.round(self.time % 60);\r\n\t\t\t\t\tif(seconds < 10)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tseconds = \"0\" + seconds;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar minutes = Math.round(self.time / 60);\r\n\t\t\t\t\tif(minutes < 10) {\r\n\t\t\t\t\t\tminutes = \"0\" + minutes;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tself.timerText.data = minutes + \":\" + seconds;\r\n\r\n\t\t\t\t\tif(self.buffer !== null) {\r\n\t\t\t\t\t\tif(self.time >= self.buffer.duration)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.stop();\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar progress = (self.time / self.buffer.duration) * 100;\r\n\r\n\t\t\t\t\t\tif(!self.dragging)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tself.progress.style.width = progress + \"%\";\r\n\t\t\t\t\t\t\tself.scrubber.style.left = progress + \"%\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(self.parent !== null) {\r\n\t\t\t\t\trequestAnimationFrame(draw);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdraw();\r\n\t\t},\r\n\r\n\t\t//Decode audio\r\n\t\tsetAudioBuffer : function(buffer, onLoad) {\r\n\t\t\tvar self = this;\r\n\r\n\t\t\tthis.context.decodeAudioData(buffer.slice(0), function(buffer) \t{\r\n\t\t\t\tself.buffer = buffer;\r\n\r\n\t\t\t\tif(onLoad !== undefined) {\r\n\t\t\t\t\tonLoad(buffer);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\t//Connect audio source\r\n\t\tconnect : function() {\r\n\t\t\tif(this.playing)\r\n\t\t\t{\r\n\t\t\t\tthis.pause();\r\n\t\t\t}\r\n\r\n\t\t\tthis.source = this.context.createBufferSource();\r\n\t\t\tthis.source.buffer = this.buffer;\r\n\t\t\tthis.source.connect(this.context.destination);\r\n\t\t},\r\n\r\n\t\t//Disconnect source\r\n\t\tdisconnect : function() {\r\n\t\t\tthis.source.disconnect();\r\n\t\t},\r\n\r\n\t\t//Play audio\r\n\t\tplay : function(time){\r\n\t\t\tthis.connect();\r\n\r\n\t\t\tif(time !== undefined)\r\n\t\t\t{\r\n\t\t\t\tthis.time = time;\r\n\t\t\t}\r\n\r\n\t\t\tthis.source.loop = this.loop;\r\n\t\t\tthis.startTime = this.context.currentTime - this.time;\r\n\t\t\tthis.source.start(this.context.currentTime, this.time);\r\n\t\t\tthis.playing = true;\r\n\r\n\t\t\tthis.icon.src = Global.FILE_PATH + \"icons/misc/pause.png\";\r\n\t\t},\r\n\r\n\t\t//Pause audio\r\n\t\tpause : function() \t{\r\n\t\t\tif(this.playing)\r\n\t\t\t{\r\n\t\t\t\tthis.playing = false;\r\n\t\t\t\tthis.source.stop();\r\n\t\t\t\tthis.time = this.context.currentTime - this.startTime;\r\n\r\n\t\t\t\tthis.icon.src = Global.FILE_PATH + \"icons/misc/play.png\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//Stop audio playback\r\n\t\tstop : function() {\t\r\n\t\t\tif(this.playing) {\r\n\t\t\t\tthis.source.stop();\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t\tthis.playing = false;\r\n\r\n\t\t\t\tthis.icon.src = Global.FILE_PATH + \"icons/misc/play.png\";\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//Seek time\r\n\t\tseek : function(time) {\r\n\t\t\tif(this.playing) {\r\n\t\t\t\tthis.play(time);\r\n\t\t\t} else \t{\r\n\t\t\t\tthis.time = time;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//Toggle play/pause\r\n\t\ttoggle : function() {\r\n\t\t\tif(!this.playing) {\r\n\t\t\t\tthis.play();\r\n\t\t\t} else {\r\n\t\t\t\tthis.pause();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdestroy : function() {\r\n\t\t\ttry {\r\n\t\t\t\tthis.disconnect();\r\n\t\t\t\tthis.stop();\r\n\t\t\t}catch(e){}\r\n\r\n\t\t\tWidget.prototype.destroy.call(this);\r\n\t\t},\r\n\r\n\t\t_updateSize : function() {\r\n\t\t\tWidget.prototype._updateSize.call(this);\r\n\r\n\t\t\t//Button\r\n\t\t\tthis.button.style.width = this._elm.style.height;\r\n\t\t\tthis.button.style.height = this._elm.style.height;\r\n\r\n\t\t\t//Track\r\n\t\t\tthis.track.style.top = (this.size.y * 0.25) + \"px\";\r\n\t\t\tthis.track.style.left = (this.size.y * 1.05) + \"px\";\r\n\t\t\tthis.track.style.width = (this.size.x - this.size.y * 1.5 - 35) + \"px\";\r\n\t\t\tthis.track.style.height = (this.size.y * 0.5) + \"px\";\r\n\r\n\t\t\t//Scrubber\r\n\t\t\tthis.scrubber.style.height = (this.size.y * 0.8) + \"px\";\r\n\t\t\tthis.scrubber.style.top = (-this.size.y * 0.15) + \"px\";\r\n\t\t}\r\n\t});\r\n\r\n\r\n\treturn medias.AudioPlayer = AudioPlayer;\r\n\r\n});"]}